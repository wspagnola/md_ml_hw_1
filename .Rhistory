knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
'
fares <- read_csv("trip_fare_8.csv")
trips <- read_csv("trip_data_8.csv")
'
trips_hw_1  <- trips %>% filter(pickup_datetime >= ymd_hms("2013-08-15 00:00:00")
& pickup_datetime < ymd_hms("2013-08-16 00:00:00"))
trips_hw_1 <- read_csv("trips_hw_1.csv")
summary(trips_hw_1)
#Look at Trip Time
trips_hw_1 %>%
arrange(trip_time_in_secs)
#Filter Trips less than 60 seconds
trips_hw_1 <- trips_hw_1 %>% filter(trip_time_in_secs > 60)
#Generate column of trip time minutes
trips_hw_1 <- trips_hw_1 %>%
mutate(trip_time_in_mins =  (trip_time_in_secs / 60))
#Generate column of trip time Hours
trips_hw_1 <- trips_hw_1 %>%
mutate(trip_time_in_hrs =  (trip_time_in_mins / 60))
#Look at Max Trip Time in descending Order
trips_hw_1 %>%
arrange(desc(trip_time_in_mins))
trips_hw_1 %>%
arrange(desc(trip_time_in_hrs))
#Filter Trip Time to be less than or equal to 3 hours
trips_hw_1 <- trips_hw_1 %>%
filter(trip_time_in_hrs  <= 3)
#Generate column of average speed
trips_hw_1 <- trips_hw_1 %>%
mutate(avg_speed = trip_distance / (trip_time_in_secs / 3600))
#Examing Average Speed
summary(trips_hw_1$avg_speed)
#Filter Average Speed to be Less than or equal to 60
trips_hw_1 <- trips_hw_1 %>%
filter(avg_speed <= 60)
#Filter Average Speed to be greater than or to 10
trips_hw_1 <- trips_hw_1 %>%
filter(avg_speed >= 10)
#Check day
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start=min(pickup_datetime)) %>%
summarize(earliest_start = min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start))
#Check day
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start=min(pickup_datetime)) %>%
summarize(earliest_start = min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start))
reprex:::reprex_addin()
trips_hw_1 %>% names
trips_hw_1 %>% names
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime))
trips_hw_1 %>%
group_by(hack_license)
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime))
trips_hw_1 %>%
group_by(hack_license) %>%
mutate(earliest_start= min(pickup_datetime)) %>%
mutate(latest_finish = max(dropoff_datetime))
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime))
#Check Work day
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start)
#Check Work day
trips_hw_1 %>%
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) )
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) )
#Check Work day
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
arrange()
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
arrange(workday_in_seconds)
#Check Longest Work Days
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
arrange(desc(workday_in_seconds))
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds < 16*3600)
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds < as.duration(16*3600))
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds < as.duration(16*3600 & workday_in_seconds > as.duration(60))
trips_hw_1 %>%
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds > as.duration(16*3600) | workday_in_seconds < as.duration(60))
trips_hw_1 %>% unique(hack_license) %>% length()
length(unique(trips_hw_1$hack_license))
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds > as.duration(16*3600) )
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds > as.duration(60) )
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds < as.duration(60) )
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds < as.duration(60) )
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds < as.duration(3600) )
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
geom_boxplot(aes(workday_in_seconds))
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
ggplot(aes(workday_in_seconds))  + geom_boxplot()
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
ggplot(aes(as.numeric(workday_in_seconds)))  + geom_boxplot()
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
ggplot(aes(as.numeric(y=workday_in_seconds)))  + geom_boxplot()
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
ggplot(aes(x=1, y= as.numeric(workday_in_seconds)))  + geom_boxplot()
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
ggplot(aes(x=1, y= as.numeric(workday_in_seconds)/3600))  + geom_boxplot()
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds < as.duration(3600) ) %>%
pull(hack_license)
less_than_1hr <- trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds < as.duration(3600) ) %>%
pull(hack_license)
#Pull License Numbers of Cab Driver Who Worked at least one Hour
at_least_1hr <- trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds >= as.duration(3600) ) %>%
pull(hack_license)
trips_hw_1 %>%
filter(hack_license %in% at_least_1hr )
nrow(trips_hw_1)
trips_hw_1 %>%
filter(hack_license %in% at_least_1hr )
nrow(trips_hw_1)
trips_hw_1 %>%
filter(hack_license %in% at_least_1hr ) %>%
nrow()
nrow(trips_hw_1) -trips_hw_1 %>%
filter(hack_license %in% at_least_1hr ) %>%
nrow()
#Calculate Total Numbwer of Drivers
length(unique(trips_hw_1$hack_license))
#Check Shortest Work Days
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
arrange(workday_in_seconds)
#Check Longest Work Days
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
arrange(desc(workday_in_seconds))
#Look at people who worked more than 16 hours
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds > as.duration(16*3600) )
#Look at people who worked less than 1 hour
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds < as.duration(3600) )
#Create Boxplot of Distribution of Hack licenses
trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
ggplot(aes(x=1, y= as.numeric(workday_in_seconds)/3600))  + geom_boxplot()
#Pull License Numbers of Cab Driver Who Worked at least one Hour
at_least_1hr <- trips_hw_1 %>%
group_by(hack_license) %>%
summarize(earliest_start= min(pickup_datetime), latest_finish = max(dropoff_datetime),
workday_in_seconds = as.duration(latest_finish- earliest_start) ) %>%
filter(workday_in_seconds >= as.duration(3600) ) %>%
pull(hack_license)
#Calculate Rows Deleted
nrow(trips_hw_1) -trips_hw_1 %>%
filter(hack_license %in% at_least_1hr ) %>%
nrow()
#Remove Cab Drivers who Worked less than 1 hours
trips_hw_1 <- trips_hw_1 %>%
filter(hack_license %in% at_least_1hr )
names(trips_hw_1)
trips_hw_1 %>%
mutate(trip_time_in_secs_2 = as.duration(dropoff_datetime - pickup_datetime) )
trips_hw_1 %>%
mutate(trip_duration = as.duration(dropoff_datetime - pickup_datetime) ) %>%
mutate(trip_diff = trip_time_in_secs - trip_duration )
trips_hw_1 %>%
mutate(trip_duration = as.duration(dropoff_datetime - pickup_datetime) ) %>%
mutate(trip_diff = trip_time_in_secs - trip_duration ) %>%
ggplot(aes(x=1, y=trip_diff)) %>%
geom_histogram()
trips_hw_1 %>%
mutate(trip_duration = as.duration(dropoff_datetime - pickup_datetime) ) %>%
mutate(trip_diff = trip_time_in_secs - trip_duration ) %>%
ggplot(aes(x=1, y=trip_diff)) +
geom_histogram()
trips_hw_1 %>%
mutate(trip_duration = as.duration(dropoff_datetime - pickup_datetime) ) %>%
mutate(trip_diff = trip_time_in_secs - as.numeric(trip_duration) ) %>%
ggplot(aes(x=1, y=trip_diff)) +
geom_histogram()
trips_hw_1 %>%
mutate(trip_duration = as.duration(dropoff_datetime - pickup_datetime) ) %>%
mutate(trip_diff = trip_time_in_secs - as.numeric(trip_duration) ) %>%
ggplot(aes(x=trip_diff)) +
geom_histogram()
trips_hw_1 %>%
mutate(trip_duration = as.duration(dropoff_datetime - pickup_datetime) ) %>%
mutate(trip_diff = trip_time_in_secs - as.numeric(trip_duration) ) %>%
ggplot(aes(x=1, y=trip_diff)) +
geom_boxplot()
trips_hw_1 %>%
mutate(trip_duration = as.duration(dropoff_datetime - pickup_datetime) ) %>%
mutate(trip_diff = abs(trip_time_in_secs - as.numeric(trip_duration)) ) %>%
ggplot(aes(x=trip_diff))+
geom_density()
trips_hw_1 %>%
mutate(trip_duration = as.duration(dropoff_datetime - pickup_datetime) ) %>%
mutate(trip_diff = abs(trip_time_in_secs - as.numeric(trip_duration)) ) %>%
filter(trip_diff<= 60)
#Remove Rows Where Difference between Dropoff - Pickup and trip_time in secs is greater than 1  minute
trips_hw_1 <- trips_hw_1 %>%
mutate(trip_duration = as.duration(dropoff_datetime - pickup_datetime) ) %>%
mutate(trip_diff = abs(trip_time_in_secs - as.numeric(trip_duration)) ) %>%
filter(trip_diff<= 60)
trips_hw_1 %>%
group_by(medallion) %>%
n()
trips_hw_1 %>%
group_by(medallion) %>%
summarize(total_trips = n())
trips_hw_1 %>%
group_by(medallion)
trips_hw_1 %>%
group_by(medallion) %>%
summarize(total_trips = n(),
total_passengers  = sum(passengers) )
names(trips_hw_1)
trips_hw_1 %>%
group_by(medallion) %>%
summarize(total_trips = n(),
total_passengers  = sum(passenger_count) )
names(trips_hw_1)
trips_hw_1 %>%
group_by(medallion) %>%
summarize(total_trips = n(),
total_passengers  = sum(passenger_count),
total_time_with_passengers = sum(trip_time_in_hrs)  )
trips_hw_1 %>%
group_by(medallion) %>%
summarize(total_trips = n(),
total_passengers  = sum(passenger_count),
total_time_with_passengers = sum(trip_time_in_hrs),
total_distance = sum(trip_distance))
summary(trips_hw_1$passenger_count)
trips_hw_1 %>%
mutate(hour = hour(date))
names(trips_hw_1)
trips_hw_1 %>%
mutate(hour = hour(pickup_datetime))
trips_hw_1 %>%
mutate(hour = hour(pickup_datetime)) %>%
group_by(hack_license, hour) %>%
summarize(total_passengers_picked_up = sum(passenger_count))
names(trips_hw_1)
trips_hw_1 %>%
mutate(hour = hour(pickup_datetime)) %>%
group_by(hack_license, hour) %>%
summarize(total_passengers_picked_up = sum(passenger_count),
trips_started = n() )
trips_hw_1 %>%
mutate(hour = hour(pickup_datetime)) %>%
group_by(hack_license, hour)
trips_hw_1 %>%
mutate(hour = hour(pickup_datetime)) %>%
group_by(hack_license, hour) %>%
summarize(total_time_with_passengers = sum(trip_time_in_hrs))
trips_hw_1 %>%
mutate(hour = hour(pickup_datetime)) %>%
group_by(hack_license, hour) %>%
summarize(total_time_with_passengers = sum(trip_time_in_mins))
